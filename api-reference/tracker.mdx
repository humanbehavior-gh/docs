---
title: 'Tracker API'
description: 'Complete API reference for HumanBehaviorTracker'
---

# HumanBehaviorTracker API

The main tracker class for recording user sessions and events.

<Info>
<strong>How to find your Public API Key:</strong><br/>
<b>Flow:</b> Project Home → Settings (on sidebar) → Public API Key
</Info>

<img src="/images/APIKey.png" alt="Where to find your Public API Key" style={{ borderRadius: '0.5rem', margin: '1rem 0', maxWidth: '100%' }} />

<p style={{ fontSize: '0.95em', color: '#888', marginTop: '-0.5rem', marginBottom: '1.5rem' }}><em>Example screenshot – your actual API key will be different.</em></p>

## Initialization

### `HumanBehaviorTracker.init(apiKey, options?)`

Static method to initialize the tracker with global persistence.

```typescript
static init(
  apiKey: string, 
  options?: {
    redactFields?: string[];
  }
): HumanBehaviorTracker
```

**Parameters:**
- `apiKey` (string): Your HumanBehavior API key
- `options` (object, optional): Configuration options
  - `redactFields` (string[], optional): CSS selectors for fields to redact

**Returns:** `HumanBehaviorTracker` instance

**Example:**
```javascript
const tracker = HumanBehaviorTracker.init('your-api-key', {
  redactFields: ['input[type="password"]', '#email']
});
```

## Core Methods

### `start()`

Start recording user sessions and events.

```typescript
async start(): Promise<void>
```

**Example:**
```javascript
await tracker.start();
```

### `stop()`

Stop recording and cleanup resources.

```typescript
async stop(): Promise<void>
```

**Example:**
```javascript
await tracker.stop();
```

### `addEvent(event)`

Add a custom event to the recording queue.

```typescript
async addEvent(event: any): Promise<void>
```

**Parameters:**
- `event` (any): Event object to record

**Example:**
```javascript
await tracker.addEvent({
  type: 'custom',
  data: { action: 'button_click' }
});
```

## User Management

### Server-side User Identification

The server-side `identifyUser` function is used for identifying users during authentication events and server-side user management. This ensures users are properly identified before any client-side tracking begins.

```typescript
import { identifyUser } from 'humanbehavior-js';

async identifyUser(
  userId: string,
  userData: {
    email: string;
    name?: string;
    image?: string;
    provider?: string;
    [key: string]: any;
  },
  apiKey: string
): Promise<{ success: boolean; error?: string; actualUserId?: string }>
```

**Parameters:**
- `userId` (string): Stable unique identifier (database user ID recommended)
- `userData` (object): User properties including email, name, image, provider, etc.
- `apiKey` (string): Your HumanBehavior API key

**Returns:** `Promise<{ success: boolean; error?: string; actualUserId?: string }>`

**Example - NextAuth Integration:**
```javascript
// In your NextAuth configuration
import { identifyUser } from 'humanbehavior-js';

export const { handlers, signIn, signOut, auth } = NextAuth({
  // ... other config
  events: {
    async signIn({ user, account, profile, isNewUser }) {
      if (user.email && process.env.NEXT_PUBLIC_HUMAN_BEHAVIOR_API_KEY) {
        const result = await identifyUser(
          user.id!, // Database user ID
          {
            email: user.email,
            name: user.name || undefined,
            image: user.image || undefined,
            provider: account?.provider || 'unknown'
          },
          process.env.NEXT_PUBLIC_HUMAN_BEHAVIOR_API_KEY
        );
        
        if (result.success) {
          console.log(`✅ User identified successfully for ${user.email}`);
        } else {
          console.error(`❌ Failed to identify user: ${result.error}`);
        }
      }
    }
  }
});
```

**Example - Firebase Auth:**
```javascript
// In your Firebase auth state listener
import { identifyUser } from 'humanbehavior-js';

onAuthStateChanged(auth, async (user) => {
  if (user && process.env.HUMANBEHAVIOR_API_KEY) {
    const result = await identifyUser(
      user.uid, // Firebase UID
      {
        email: user.email,
        name: user.displayName,
        image: user.photoURL,
        provider: user.providerData[0]?.providerId
      },
      process.env.HUMANBEHAVIOR_API_KEY
    );
  }
});
```

### Client-side User Identification

For client-side user identification and client-only applications, use the tracker instance method:

```typescript
async identifyUser(
  { userId, userProperties }: { 
    userId?: string, 
    userProperties: Record<string, any> 
  }
): Promise<string>
```

**Parameters:**
- `userId` (string, optional): User identifier
- `userProperties` (object): User properties

**Returns:** `Promise<string>` - The user ID that was set

**Example:**
```javascript
// Client-side usage for client-only applications
const userId = await tracker.identifyUser({
  userId: user.id,
  userProperties: {
    email: user.email,
    name: user.name,
    plan: user.plan
  }
});
```







## Data Redaction

### `redact(options?)`

Enable data redaction for sensitive fields.

```typescript
async redact(options?: RedactionOptions): Promise<void>
```

**Parameters:**
- `options` (RedactionOptions, optional): Redaction configuration

**Example:**
```javascript
await tracker.redact({
  maskTextInputs: true,
  maskAllText: false
});
```

### `setRedactedFields(fields)`

Set specific fields to be redacted.

```typescript
setRedactedFields(fields: string[]): void
```

**Parameters:**
- `fields` (string[]): Array of CSS selectors for fields to redact

**Example:**
```javascript
tracker.setRedactedFields([
  'input[type="password"]',
  '#email-field',
  '.sensitive-data'
]);
```

### `isRedactionActive()`

Check if redaction is currently active.

```typescript
isRedactionActive(): boolean
```

**Returns:** `boolean`

**Example:**
```javascript
if (tracker.isRedactionActive()) {
  console.log('Redaction is enabled');
}
```

### `getRedactedFields()`

Get the currently selected fields for redaction.

```typescript
getRedactedFields(): string[]
```

**Returns:** `string[]`

**Example:**
```javascript
const fields = tracker.getRedactedFields();
console.log('Redacted fields:', fields);
```

## User Information

### `getUserInfo()`

Get comprehensive user information.

```typescript
getUserInfo(): {
  endUserId: string | null;
  sessionId: string;
  isPreexistingUser: boolean;
  initialized: boolean;
}
```

**Returns:** User information object

**Example:**
```javascript
const userInfo = tracker.getUserInfo();
console.log('User ID:', userInfo.endUserId);
console.log('Session ID:', userInfo.sessionId);
console.log('Is existing user:', userInfo.isPreexistingUser);
```

### `getSessionId()`

Get the current session ID.

```typescript
getSessionId(): string
```

**Returns:** `string`

**Example:**
```javascript
const sessionId = tracker.getSessionId();
console.log('Current session:', sessionId);
```

### `getCurrentUrl()`

Get the current URL being tracked.

```typescript
getCurrentUrl(): string
```

**Returns:** `string`